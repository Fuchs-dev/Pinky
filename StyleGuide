# Pinky ‚Äì Coding Styleguide & Konventionen (STYLEGUIDE.md)

## Ziel
Dieses Dokument definiert verbindliche Coding-Standards f√ºr das Pinky-Projekt.  
Es stellt Konsistenz sicher und verhindert Wildwuchs ‚Äì insbesondere bei KI-gest√ºtzter Entwicklung (Codex, Copilot, etc.).

Die hier gezeigten **Beispiele sind verbindlich** und dienen als Referenz.

---

## Allgemeine Prinzipien
- Lesbarkeit vor Cleverness
- Klarheit vor Abstraktion
- Explizit statt ‚Äûmagisch‚Äú
- Eine Datei = eine Verantwortung
- Code wird h√§ufiger gelesen als geschrieben

 **Schlecht:**
```ts
doStuff(data)

**Gut**
createMicroTasksFromTask(taskInput)

Projektstruktur
Feature-first statt Layer-first

Code wird nach fachlichen Features organisiert, nicht nach technischen Layern.

**Schlecht:**
controllers/
services/
models/

**Gut**
tasks/
  task.controller.ts
  task.service.ts
  task.schema.ts
Keine ‚Äûutils‚Äú-Sammelordner ohne klaren Zweck.

TypeScript (Backend & Web)
Benennung

Variablen & Funktionen: camelCase

Klassen, Typen, Interfaces: PascalCase

Dateinamen: kebab-case.ts

Beispiel:
const activeOrganizationId: string;

function assignMicroTaskToUser() {}

type MicroTaskStatus = "OPEN" | "ASSIGNED" | "DONE";

Nicht erlaubt:
const ActiveOrgID;
function do_it();

Typisierung & Validation

Kein any

API-Grenzen immer typisieren

Zod ist die Source of Truth f√ºr eingehende Daten

‚úÖ Beispiel (Zod):

export const createTaskSchema = z.object({
  title: z.string().min(3),
  description: z.string().optional(),
});


‚ùå Schlecht:

function createTask(data: any) {}

Backend-Architektur
Controller

Aufgaben:

Request entgegennehmen

Input validieren

Service aufrufen

Response zur√ºckgeben

‚úÖ Beispiel:

export async function createTaskController(req, res) {
  const input = createTaskSchema.parse(req.body);
  const task = await taskService.createTask(input, req.user);
  res.json(task);
}


‚ùå Schlecht (Business-Logik im Controller):

if (user.role === "ADMIN") {
  prisma.task.create(...)
}

Service

Aufgaben:

Enth√§lt Business-Logik

Kennt Rollen, Regeln und Abl√§ufe

Greift auf die Datenbank zu

‚úÖ Beispiel:

export async function createTask(input, user) {
  assertCanCreateTask(user);

  return prisma.task.create({
    data: {
      ...input,
      organizationId: user.activeOrganizationId,
    },
  });
}

Fehlerbehandlung

Keine String-Throws

Einheitliche Error-Typen

‚úÖ Beispiel:

throw new ForbiddenError("User is not allowed to create tasks");


‚ùå Schlecht:

throw "not allowed";

Flutter / Dart (Mobile App)
Dateinamen & Klassen

Dateien: snake_case.dart

Klassen & Widgets: PascalCase

‚úÖ Beispiel:

microtask_list_screen.dart

class MicroTaskListScreen extends StatelessWidget {}

Keine Logik in Widgets

Widgets sind UI only.

‚ùå Schlecht:

onPressed: () {
  api.assignTask(id);
  state = "done";
}


‚úÖ Gut:

onPressed: () {
  ref.read(microTaskControllerProvider).assign(id);
}

State Management

Riverpod (oder √§quivalent)

State & Logik in Controllern/Notifiers

UI konsumiert nur State

‚úÖ Beispiel:

final microTaskControllerProvider =
  StateNotifierProvider<MicroTaskController, AsyncValue<List<MicroTask>>>(
    (ref) => MicroTaskController(ref),
  );

Tests
Backend

Business-Logik wird getestet

Keine Tests f√ºr triviale Getter/Setter

‚úÖ Beispiel:

it("assigns microtask to user", async () => {
  const task = await assignMicroTask(user, microTask);
  expect(task.status).toBe("ASSIGNED");
});

Web & Mobile

Smoke-Tests ausreichend f√ºr Beta

Fokus auf kritische Flows

KI-spezifische Regeln (verbindlich)
KI darf:

Features gem√§√ü Ticket implementieren

Code refactoren im bestehenden Stil

Tests erg√§nzen oder verbessern

KI darf NICHT:

Architekturentscheidungen √§ndern

neue Frameworks oder State-Patterns einf√ºhren

bestehende Konventionen ignorieren

Business-Logik in Clients verschieben

KI muss folgende Dokumente respektieren:

PROJECT.md

ARCHITECTURE.md

DOMAIN.md

DECISIONS.md

STYLEGUIDE.md

Code Reviews

Konsistenz schl√§gt pers√∂nlichen Geschmack

Abweichungen m√ºssen begr√ºndet sein

Existiert ein Beispiel, ist diesem zu folgen

Geltungsbereich

Dieser Styleguide gilt f√ºr:

Backend

Web App

Mobile App

Er ist verbindlich f√ºr:

menschliche Entwickler

KI-Tools (Codex, Copilot, etc.)


---

Wenn du m√∂chtest, kann ich als N√§chstes:
- den **Text sprachlich minimal gl√§tten**, ohne Inhalt zu √§ndern  
- oder ihn **auf Deutsch/Englisch vereinheitlichen**  
- oder ein **Ticket-Template**, das explizit auf diesen Styleguide verweist

Sag einfach, wie es weitergehen soll üëç

